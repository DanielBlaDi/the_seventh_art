<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocky - Principal Home</title>
    <link rel="stylesheet" href="css/principal_home.css">
</head>
<body>
<div class="app-container">
    <div class="content-wrapper">
        <div class="dashboard-content">

            <!-- ========== TÃTULO + SUBTÃTULO ========== -->
            <div class="mb-6">
                <h1 class="page-title font-bold"
                    th:text="'Â¡Hola ' + ${perfil.nombre} + '!'">
                    Hola Usuario
                </h1>
                <p class="text-muted-foreground">AquÃ­ estÃ¡ tu progreso de hoy</p>
            </div>

            <!-- ========== MENSAJE DEL DÃA ========== -->
            <div data-slot="card" class="card card-message-of-day mb-6">
                <div class="flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="icon-svg flex-shrink-0" aria-hidden="true">
                        <path d="M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"></path>
                    </svg>
                    <div>
                        <h3 class="text-white mb-1 font-semibold">Mensaje del DÃ­a</h3>
                        <p class="text-white-90">No cuentes los dÃ­as, haz que los dÃ­as cuenten. ðŸŽ¯</p>
                    </div>
                </div>
            </div>

            <!-- ========== RUTINA EN CURSO (se muestra solo si hay sessionStorage) ========== -->
            <div
                    id="cardRutinaEnCurso"
                    data-slot="card"
                    class="card card-routine-active mb-6"
                    style="display: none;"
            >
                <div class="flex items-center justify-between gap-4">
                    <!-- Izquierda: icono + textos -->
                    <div class="flex items-center gap-3">
                        <div class="icon-circle icon-bg-indigo">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="icon-svg h-5 w-5 text-white" aria-hidden="true">
                                <path d="M12 6v6l4 2"></path>
                                <circle cx="12" cy="12" r="10"></circle>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-muted-foreground">Rutina en curso</p>
                            <h4 id="rutinaEnCursoNombre" class="font-semibold">Rutina</h4>
                            <p id="rutinaEnCursoProgreso"
                               class="text-sm text-muted-foreground">
                                0 de 0 ejercicios completados
                            </p>
                        </div>
                    </div>

                    <!-- Derecha: botÃ³n X + botÃ³n Continuar -->
                    <div class="flex items-center gap-2">
                        <!-- BotÃ³n cancelar rutina (X) -->
                        <button
                                id="btnCancelarRutina"
                                type="button"
                                class="btn btn-ghost btn-icon"
                                title="Cancelar rutina en curso">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="icon-svg h-4 w-4" aria-hidden="true">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>

                        <!-- BotÃ³n continuar -->
                        <button type="button" class="btn btn-primary" id="btnContinuarRutina">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="icon-svg h-4 w-4 mr-2" aria-hidden="true">
                                <path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"></path>
                            </svg>
                            Continuar
                        </button>
                    </div>
                </div>
            </div>

            <!-- ========== STATS (3 bloques pequeÃ±os) ========== -->
            <div class="stats-grid mb-6">
                <!-- Racha semanal -->
                <div
                        data-slot="card"
                        class="card-stat-small bg-card text-card-foreground rounded-xl border flex flex-col items-start p-4"
                >
                    <div class="flex items-center gap-3">
                        <div class="icon-circle icon-bg-green-100">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-trophy h-5 w-5 text-green-700" aria-hidden="true">
                                <path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"></path>
                                <path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"></path>
                                <path d="M18 9h1.5a1 1 0 0 0 0-5H18"></path>
                                <path d="M4 22h16"></path>
                                <path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path>
                                <path d="M6 9H4.5a1 1 0 0 1 0-5H6"></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-muted-foreground">Racha Semanal</p>
                            <h4 class="font-semibold text-lg">3 semanas</h4>
                        </div>
                    </div>
                </div>

                <!-- Esta semana -->
                <div
                        data-slot="card"
                        class="card-stat-small bg-card text-card-foreground rounded-xl border flex flex-col items-start p-4"
                >
                    <div class="flex items-center gap-3">
                        <div class="icon-circle icon-bg-blue-100">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-calendar h-5 w-5 text-blue-600" aria-hidden="true">
                                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                                <line x1="16" x2="16" y1="2" y2="6"></line>
                                <line x1="8" x2="8" y1="2" y2="6"></line>
                                <line x1="3" x2="21" y1="10" y2="10"></line>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-muted-foreground">Esta Semana</p>
                            <h4 class="font-semibold text-lg">5/6</h4>
                        </div>
                    </div>
                </div>

                <!-- Tiempo total -->
                <div
                        data-slot="card"
                        class="card-stat-small bg-card text-card-foreground rounded-xl border flex flex-col items-start p-4"
                >
                    <div class="flex items-center gap-3">
                        <div class="icon-circle icon-bg-purple-100">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-clock h-5 w-5 text-purple-600" aria-hidden="true">
                                <path d="M12 6v6l4 2"></path>
                                <circle cx="12" cy="12" r="10"></circle>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-muted-foreground">Tiempo Total</p>
                            <h4 class="font-semibold text-lg">89 hrs</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== BLOQUE ESTADÃSTICAS ========== -->
            <div
                    data-slot="card"
                    class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border p-6 mb-6"
            >
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold">EstadÃ­sticas</h3>

                    <a href="estadisticas.html"
                       class="inline-flex items-center justify-center whitespace-nowrap text-sm font-bold border bg-background h-8 rounded-md gap-1.5 px-3 border-indigo-200 text-indigo-600 hover:bg-indigo-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                             viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="lucide lucide-chart-column h-4 w-4 mr-2" aria-hidden="true">
                            <path d="M3 3v16a2 2 0 0 0 2 2h16"></path>
                            <path d="M18 17V9"></path>
                            <path d="M13 17V5"></path>
                            <path d="M8 17v-3"></path>
                        </svg>
                        Bloque de estadÃ­sticas
                    </a>
                </div>

                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-muted-foreground">Total de entrenamientos</span>
                        <span class="font-medium">156</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-muted-foreground">Horas de ejercicio</span>
                        <span class="font-medium">89 hrs</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-muted-foreground">Promedio semanal</span>
                        <span class="font-medium">5 entrenamientos</span>
                    </div>
                </div>
            </div>

            <!-- ========== PROGRESO SEMANAL ========== -->
            <div
                    data-slot="card"
                    class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border p-6 mb-6"
            >
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <h3 class="font-semibold">Progreso Semanal</h3>
                        <div class="flex items-center gap-1 px-2 py-1 bg-green-100 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-trophy h-3 w-3 text-green-600" aria-hidden="true">
                                <path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"></path>
                                <path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"></path>
                                <path d="M18 9h1.5a1 1 0 0 0 0-5H18"></path>
                                <path d="M4 22h16"></path>
                                <path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path>
                                <path d="M6 9H4.5a1 1 0 0 1 0-5H6"></path>
                            </svg>
                            <span class="text-xs text-green-700 font-medium">3 semanas</span>
                        </div>
                    </div>
                    <span class="text-sm text-muted-foreground">5 de 6 entrenamientos</span>
                </div>

                <div
                        class="bg-progress-bg relative h-2 w-full overflow-hidden rounded-full mb-2"
                        data-slot="progress"
                        role="progressbar"
                        aria-valuemin="0"
                        aria-valuemax="100"
                >
                    <div
                            class="bg-progress-indicator h-full transition-all rounded-full"
                            data-slot="progress-indicator"
                            style="width: 83.33%;"
                    ></div>
                </div>

                <p class="text-sm text-muted-foreground">
                    Te falta 1 entrenamiento para mantener tu racha de 3 semanas
                </p>
            </div>

            <!-- ========== ACTIVIDAD RECIENTE ========== -->
            <div data-slot="card" class="card card-lg">
                <div class="flex items-center gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="icon-svg h-5 w-5 text-indigo-600" aria-hidden="true">
                        <path d="M16 7h6v6"></path>
                        <path d="m22 7-8.5 8.5-5-5L2 17"></path>
                    </svg>
                    <h3 class="text-lg font-semibold">Actividad Reciente</h3>
                </div>

                <div class="space-y-4 activity-list">

                    <!-- Mensaje si no hay actividad -->
                    <div th:if="${#lists.isEmpty(actividadesRecientes)}"
                         class="text-sm text-muted-foreground">
                        AÃºn no tienes actividad reciente. Â¡Comienza una rutina hoy! ðŸ’ª
                    </div>

                    <!-- Lista de actividades -->
                    <div th:each="actividad, iterStat : ${actividadesRecientes}"
                         class="flex items-center justify-between"
                         th:classappend="${!iterStat.last} ? ' pb-3 border-b' : ''">
                        <div>
                            <!-- Nombre de la rutina -->
                            <p class="font-medium"
                               th:text="${actividad.nombreRutina}">
                                Rutina de Ejemplo
                            </p>

                            <!-- "Hace X dÃ­as â€¢ Y min" -->
                            <p class="text-sm text-muted-foreground"
                               th:text="${actividad.tiempoRelativo} + ' â€¢ ' + ${actividad.duracion}">
                                Hace 2 dÃ­as â€¢ 45 min
                            </p>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <!-- ========== MODAL: RUTINA EN CURSO ========== -->
    <div id="modalRutinaEnCurso" class="modal hidden" aria-hidden="true">
        <div class="modal-box modal-desktop" role="dialog"
             aria-modal="true" aria-labelledby="modalRutinaTitulo">

            <!-- Header -->
            <div class="modal-header" style="background:#4F46E5; color:white;">
                <div class="modal-header-left">
                    <h3 id="modalRutinaTitulo" class="font-bold">Rutina en Curso</h3>
                    <p id="modalRutinaSubtitulo" class="text-sm">0 de 0 ejercicios</p>
                </div>

                <div class="modal-header-right">
                    <!-- CronÃ³metro total de la rutina -->
                    <div class="rutina-timer-header">
                        <span class="rutina-timer-label text-xs">Tiempo total:</span>
                        <span id="rutinaTiempoTotal" class="rutina-timer-value text-sm">0:00</span>
                        <button
                                type="button"
                                id="btnToggleTimerRutina"
                                class="rutina-timer-btn"
                                title="Pausar / Reanudar"
                        >
                            â–Œâ–Œ
                        </button>
                    </div>

                    <button
                            id="cerrarModalRutina"
                            class="close-btn"
                            title="Cerrar"
                    >
                        Ã—
                    </button>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body" style="max-height:70vh; overflow:auto;">
                <div id="listaEjerciciosRutinaModal" class="space-y-3">
                    <!-- AquÃ­ se pintan dinÃ¡micamente los ejercicios -->
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer">
                <button id="btnCerrarRutina" class="btn cancelar">Cerrar</button>
                <button id="btnEmpezarDesdeModal" class="btn crear">
                    Finalizar Rutina
                </button>
            </div>
        </div>
    </div>

    <!-- ========== MODAL: CONFIRMAR CANCELAR RUTINA ========== -->
    <div id="modalConfirmCancelarRutina" class="modal hidden" aria-hidden="true">
        <div class="modal-box modal-confirm-small" role="dialog" aria-modal="true">
            <h3 class="modal-confirm-title">Cancelar rutina en curso</h3>
            <p class="modal-confirm-text">
                Â¿Seguro que quieres cancelar esta rutina en curso?<br>
                Se perderÃ¡ el tiempo y las series registradas.
            </p>

            <div class="modal-confirm-footer">
                <button
                        id="btnConfirmCancelarRutinaCancelar"
                        type="button"
                        class="btn cancelar">
                    Volver
                </button>

                <button
                        id="btnConfirmCancelarRutinaAceptar"
                        type="button"
                        class="btn crear">
                    SÃ­, cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- ========== NAV INFERIOR ========== -->
    <nav class="fixed-nav">
        <a href="principal_home" class="nav-item active">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="icon-svg h-6 w-6">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            <span class="text-xs">Inicio</span>
        </a>

        <a href="rutinas" class="nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="icon-svg h-6 w-6" aria-hidden="true">
                <path d="M13 5h8"></path>
                <path d="M13 12h8"></path>
                <path d="M13 19h8"></path>
                <path d="m3 17 2 2 4-4"></path>
                <path d="m3 7 2 2 4-4"></path>
            </svg>
            <span class="text-xs">Mis Rutinas</span>
        </a>

        <a href="perfil" class="nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="icon-svg h-6 w-6">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="text-xs">Perfil</span>
        </a>
    </nav>
</div>

<script src="js/principal_home_rutina.js"></script>
</body>
</html>
