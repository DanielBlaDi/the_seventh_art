<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{home/layout :: head('Registro')}"></head>

<body class="bg-auth">
<main class="card card--narrow">
    <div class="logo-circle">
        <img th:src="@{/images/multipurpose/gym.png}"
             src="/images/multipurpose/gym.png"
             alt="Logo"
             class="logo-img">
    </div>

    <h1 class="title">Crear Cuenta</h1>
    <p class="subtitle">Paso 1 de 3</p>

    <!-- barra de pasos -->
    <div class="steps">
        <span class="step is-active"></span>
        <span class="step"></span>
        <span class="step"></span>
    </div>

    <form class="form" th:action="@{/registro}" method="post">
        <label class="form-label" for="email">Correo Electrónico</label>
        <input class="form-input"
               id="email"
               name="email"
               type="email"
               placeholder="tu@email.com"
               th:value="${email}"
               required>

        <label class="form-label" for="password">Contraseña</label>
        <div class="password-field">
            <input class="form-input" id="password" name="password" type="password" placeholder="••••••••" required>
            <button type="button" class="password-toggle" aria-label="Mostrar contraseña">
                <svg class="eye-icon eye-open" viewBox="0 0 24 24">
                    <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0
                     12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
                </svg>

                <svg class="eye-icon eye-closed" viewBox="0 0 24 24">
                    <path d="M17.94 17.94L6.06 6.06M10.58 10.58a3 3 0 0 0 4.24 4.24M12
                     5c-5 0-9.27 3.11-11 7a13.32 13.32 0 0 0 3.07 4.11M21
                     12a13.31 13.31 0 0 0-3.06-4.11"/>
                </svg>
            </button>
        </div>

        <label class="form-label" for="password2">Confirmar Contraseña</label>
        <div class="password-field">
            <input class="form-input" id="password2" name="password2" type="password" placeholder="••••••••" required>
            <button type="button" class="password-toggle" aria-label="Mostrar contraseña">
                <svg class="eye-icon eye-open" viewBox="0 0 24 24">
                    <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0
                     12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
                </svg>

                <svg class="eye-icon eye-closed" viewBox="0 0 24 24">
                    <path d="M17.94 17.94L6.06 6.06M10.58 10.58a3 3 0 0 0 4.24 4.24M12
                     5c-5 0-9.27 3.11-11 7a13.32 13.32 0 0 0 3.07 4.11M21
                     12a13.31 13.31 0 0 0-3.06-4.11"/>
                </svg>
            </button>
        </div>

        <button class="btn btn-primary btn--full form-submit" type="submit">Crear Cuenta</button>

        <p class="auth-foot">
            ¿Ya tienes una cuenta?
            <a th:href="@{/login}" class="link-inline">Inicia sesión</a>
        </p>
        <ul class="error-list" th:if="${error}">
            <li th:each="err : ${error}" th:text="${err}"></li>
        </ul>
    </form>
</main>

<footer th:replace="~{home/layout :: footer}"></footer>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        const form = document.querySelector(".form");
        const pwd1 = document.getElementById("password");
        const pwd2 = document.getElementById("password2");

        function validar() {
            if (pwd1.value && pwd2.value && pwd1.value !== pwd2.value) {
                pwd2.setCustomValidity("Las contraseñas no coinciden.");
            } else {
                pwd2.setCustomValidity("");
            }
        }

        pwd1.addEventListener("input", validar);
        pwd2.addEventListener("input", validar);

        form.addEventListener("submit", function (e) {
            validar();
            if (!form.checkValidity()) {
                e.preventDefault();
                form.reportValidity();
            }
        });

        document.querySelectorAll(".password-toggle").forEach(btn => {
            btn.addEventListener("click", () => {
                const input = btn.closest(".password-field").querySelector("input");
                if (input.type === "password") {
                    input.type = "text";
                    btn.classList.add("active");
                } else {
                    input.type = "password";
                    btn.classList.remove("active");
                }
            });
        });

    });
</script>

</body>
</html>
